Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_points_jitter(width = 10, height = 0), point_shape = '|', point_size = 3,  point_alpha = 1, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c"))
continent_info %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP),
Age_BP <= 1000) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_raincloud(width = 12, height = 0.4), point_size = 0.5,  point_alpha = 0.5, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c"))
continent_info  %>%
mutate(Full = ifelse(Sample_type == "calculus" & str_detect(Full, "Baboon|Chimpanzee|Gorilla|Howler"),"NHP - calculus", Full)) %>%
filter(Country != "Venezuela") %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP)) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
# filter(Continent == "South America")
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 500, jittered_points = TRUE, position = position_points_jitter(width = 0.05, height = 0), point_shape = '|', point_size = 3, point_alpha = 1, alpha = 1.0,  scale = 0.9) + # rel_min_height = 0.01 scale = 0.9
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) + # breaks=scales::pretty_breaks(n=10)
scale_y_discrete(position = "right") +
theme_minimal(base_size = 14) +
scale_fill_manual(values = c("#feb24c")) +
theme(panel.grid.minor.x = element_blank())
continent_info %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP),
Age_BP <= 1000) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_raincloud(width = 12, height = 0.4), point_size = 0.5,  point_alpha = 0.5, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c"))
continent_info %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP),
Age_BP <= 1000) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_points_jitter(width = 10, height = 0), point_shape = '|', point_size = 3,  point_alpha = 1, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c"))
all_samples_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray90") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
# scale_color_gradient(low = "gray90", high = "#e6778e", na.value = "white", name = "No. samples", breaks=c(1000,2000,3000,4000,5000,6000,7000)) + # e6778e 77e6cf
scale_size_continuous(range = c(1,10)) +
theme_void() +
# theme_minimal() +
theme(panel.grid.major = element_blank())
all_samples_world
# ggsave("./06-publication/tmp_figures/world_sm_plot2.pdf", plot = world_sm_plot, device = "pdf",
#        scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
# scale_color_gradient(low = "gray90", high = "#e6778e", na.value = "white", name = "No. samples", breaks=c(1000,2000,3000,4000,5000,6000,7000)) + # e6778e 77e6cf
scale_size_continuous(range = c(2,12)) +
theme_void() +
# theme_minimal() +
theme(panel.grid.major = element_blank())
# ggsave("./06-publication/tmp_figures/world_sm_plot2.pdf", plot = world_sm_plot, device = "pdf",
#        scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
ac_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_ac_age_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 3.0, scale_y = 4.0, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(2,12)) +
theme_void() +
# theme_minimal() +
theme(panel.grid.major = element_blank())
ac_world
# separate map of Europe
# pull Europe out of the world
europe <- world %>%
filter(continent == "Europe", !is.na(iso_a2)) # , iso_a2 != "RU"
europe_ac_counts <- continent_ac_age_counts %>%
filter(Continent == "Europe")
ac_europe <- ggplot(europe) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = europe_ac_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 1.0, scale_y = 0.5, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
ylim(35,60) +
xlim(-10,30) +
theme_void() +
# theme_minimal() +
theme(panel.grid.major = element_blank())
ac_europe
ac_age_ridge <- continent_info  %>%
mutate(Full = ifelse(Sample_type == "calculus" & str_detect(Full, "Baboon|Chimpanzee|Gorilla|Howler"),"NHP - calculus", Full)) %>%
filter(Country != "Venezuela") %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP)) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
# filter(Continent == "South America")
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 500, jittered_points = TRUE, position = position_points_jitter(width = 0.05, height = 0),
point_shape = '|', point_size = 3, point_alpha = 1, alpha = 1.0,  scale = 0.9) + # rel_min_height = 0.01 scale = 0.9
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) + # breaks=scales::pretty_breaks(n=10)
scale_y_discrete(position = "right") +
theme_minimal(base_size = 14) +
scale_fill_manual(values = c("#feb24c")) +
theme(panel.grid.minor.x = element_blank())
ac_age_ridge
continent_info %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP),
Age_BP <= 1000) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_raincloud(width = 12, height = 0.4), point_size = 0.5,  point_alpha = 0.5, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c"))
continent_info %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP),
Age_BP <= 1000) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_points_jitter(width = 10, height = 0), point_shape = '|', point_size = 3,  point_alpha = 1, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c"))
all_samples_world + ac_world / ac_europe + ac_world_ridge
all_samples_world + ac_world / ac_europe + ac_age_ridge
(all_samples_world + ac_world) / (ac_europe + ac_age_ridge) +
plot_layout(guides = "collect")
ac_age_ridge <- continent_info  %>%
mutate(Full = ifelse(Sample_type == "calculus" & str_detect(Full, "Baboon|Chimpanzee|Gorilla|Howler"),"NHP - calculus", Full)) %>%
filter(Country != "Venezuela") %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP)) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
# filter(Continent == "South America")
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 500, jittered_points = TRUE, position = position_points_jitter(width = 0.05, height = 0),
point_shape = '|', point_size = 3, point_alpha = 1, alpha = 1.0,  scale = 0.9) + # rel_min_height = 0.01 scale = 0.9
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) + # breaks=scales::pretty_breaks(n=10)
scale_y_discrete(position = "right") +
theme_classic(base_size = 14) +
scale_fill_manual(values = c("#feb24c")) +
theme(panel.grid.minor.x = element_blank())
ac_age_ridge
(all_samples_world + ac_world) / (ac_europe + ac_age_ridge) +
plot_layout(guides = "collect")
# ggsave("./06-publication/tmp_figures/world_sm_plot2.pdf", plot = world_sm_plot, device = "pdf",
#        scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
all_samples_world + ac_age_ridge +
plot_layout(guides = "collect")
ac_world) + ac_europes +
all_samples_world + ac_age_ridge +
plot_layout(guides = "collect")
ac_world + ac_europes +
plot_layout(guides = "collect")
all_samples_world + ac_age_ridge +
plot_layout(guides = "collect")
ac_world + ac_europe +
plot_layout(guides = "collect")
(all_samples_world + ac_world) / (ac_europe + ac_age_ridge) +
plot_layout(guides = "collect")
all_samples_world + ac_age_ridge +
plot_layout(guides = "collect")
ac_world + ac_europe +
plot_layout(guides = "collect")
# ggsave("./06-publication/tmp_figures/world_sm_plot2.pdf", plot = world_sm_plot, device = "pdf",
#        scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
ac_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_ac_age_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 3.0, scale_y = 4.0, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
theme_void() +
# theme_minimal() +
theme(panel.grid.major = element_blank())
ac_world
(all_samples_world + ac_world) / (ac_europe + ac_age_ridge) +
plot_layout(guides = "collect")
all_samples_world + ac_age_ridge +
plot_layout(guides = "collect")
ac_world + ac_europe +
plot_layout(guides = "collect")
# ggsave("./06-publication/tmp_figures/world_sm_plot2.pdf", plot = world_sm_plot, device = "pdf",
#        scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
continent_info %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP),
Age_BP <= 1000) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
arrange(Continent) %>%
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 10, jittered_points = TRUE, position = position_points_jitter(width = 10, height = 0), point_shape = '|', point_size = 3,  point_alpha = 1, alpha = 1.0, scale = 0.9) + # rel_min_height = 0.01 scale = 0.9 position_points_jitter(width = 0.05, height = 0), point_shape = '|'
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) +
scale_y_discrete(position = "right") +
theme_classic() +
scale_fill_manual(values = c("#feb24c")) +
guides(fill="none")
ac_age_ridge <- continent_info  %>%
mutate(Full = ifelse(Sample_type == "calculus" & str_detect(Full, "Baboon|Chimpanzee|Gorilla|Howler"),"NHP - calculus", Full)) %>%
filter(Country != "Venezuela") %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP)) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
# filter(Continent == "South America")
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 500, jittered_points = TRUE, position = position_points_jitter(width = 0.05, height = 0),
point_shape = '|', point_size = 3, point_alpha = 1, alpha = 1.0,  scale = 0.9) + # rel_min_height = 0.01 scale = 0.9
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) + # breaks=scales::pretty_breaks(n=10)
scale_y_discrete(position = "right") +
theme_classic(base_size = 14) +
scale_fill_manual(values = c("#feb24c")) +
theme(panel.grid.minor.x = element_blank()) +
guides(fill="none")
ac_age_ridge
all_samples_world + ac_age_ridge +
plot_layout(guides = "collect")
ac_world + ac_europe +
plot_layout(guides = "collect")
all_samples_world + ac_age_ridge
ac_age_ridge <- continent_info  %>%
mutate(Full = ifelse(Sample_type == "calculus" & str_detect(Full, "Baboon|Chimpanzee|Gorilla|Howler"),"NHP - calculus", Full)) %>%
filter(Country != "Venezuela") %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP)) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
# filter(Continent == "South America")
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 200, jittered_points = TRUE, position = position_points_jitter(width = 0.05, height = 0),
point_shape = '|', point_size = 3, point_alpha = 1, alpha = 1.0,  scale = 0.9) + # rel_min_height = 0.01 scale = 0.9
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) + # breaks=scales::pretty_breaks(n=10)
scale_y_discrete(position = "right") +
theme_classic(base_size = 14) +
scale_fill_manual(values = c("#feb24c")) +
theme(panel.grid.minor.x = element_blank()) +
guides(fill="none")
ac_age_ridge
all_samples_world + ac_age_ridge
ac_world + ac_europe +
plot_layout(guides = "collect")
all_samples_world / ac_age_ridge
ac_world / ac_europe +
plot_layout(guides = "collect")
ac_world + ac_europe +
plot_layout(guides = "collect")
View(continent_ac_age_counts)
View(europe_ac_counts)
all_samples_world / ac_age_ridge
ac_world + ac_europe +
plot_layout(guides = "collect", heights = c(1,1.2))
all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1,1.2))
all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1.2,1))
all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1.5,1))
ac_world + ac_europe +
plot_layout(guides = "collect")
europe_ac_counts <- continent_ac_age_counts %>%
filter(Continent == "Europe") %>%
# add Efate for maintaining the color scale with the full world plot
bind_rows(., continent_ac_age_counts %>%
filter(Country == "Efate"))
View(europe_ac_counts)
ac_europe <- ggplot(europe) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = europe_ac_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 1.0, scale_y = 0.5, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
ylim(35,60) +
xlim(-10,30) +
theme_void() +
# theme_minimal() +
theme(panel.grid.major = element_blank())
ac_europe
all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1.5,1))
ac_world + ac_europe +
plot_layout(guides = "collect")
ac_europe <- ggplot(europe) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = europe_ac_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 1.0, scale_y = 0.5, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
ylim(35,60) +
xlim(-10,30) +
theme_void() +
labs(fill = "Age (BP)", size = "No. Samples") +
theme(panel.grid.major = element_blank())
ac_europe
ac_europe <- ggplot(europe) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = europe_ac_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 1.0, scale_y = 0.5, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
ylim(35,60) +
xlim(-10,30) +
theme_void() +
labs(fill = "Age (BP)", size = "No. Samples", shape = NA) +
theme(panel.grid.major = element_blank())
ac_europe
ac_europe <- ggplot(europe) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = europe_ac_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 1.0, scale_y = 0.5, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
ylim(35,60) +
xlim(-10,30) +
theme_void() +
labs(fill = "Age (BP)", size = "No. Samples") +
guides(shape = "none") +
theme(panel.grid.major = element_blank())
ac_europe
ac_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_ac_age_counts, aes(long, lat, fill = la_ch, shape = Full, size = counts), scale_x = 3.0, scale_y = 4.0, stroke = 0.2, color = "black") +
scale_shape_manual(values = c(23)) +
scale_fill_viridis_c(option = "G", direction = -1) +
scale_size_continuous(range = c(1,9)) +
theme_void() +
labs(fill = "Age (BP)", size = "No. Samples") +
guides(shape = "none") +
theme(panel.grid.major = element_blank())
ac_world
ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
# scale_color_gradient(low = "gray90", high = "#e6778e", na.value = "white", name = "No. samples", breaks=c(1000,2000,3000,4000,5000,6000,7000)) + # e6778e 77e6cf
scale_size_continuous(range = c(2,12)) +
theme_void() +
labs(fill = "Sample type", size = "No. Samples", shape = "No. Samples") +
theme(panel.grid.major = element_blank())
all_samples_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray90") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
# scale_color_gradient(low = "gray90", high = "#e6778e", na.value = "white", name = "No. samples", breaks=c(1000,2000,3000,4000,5000,6000,7000)) + # e6778e 77e6cf
scale_size_continuous(range = c(1,10)) +
theme_void() +
labs(fill = "Sample type", size = "No. Samples", shape = "No. Samples") +
theme(panel.grid.major = element_blank())
all_samples_world
all_samples_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray90") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
# scale_color_gradient(low = "gray90", high = "#e6778e", na.value = "white", name = "No. samples", breaks=c(1000,2000,3000,4000,5000,6000,7000)) + # e6778e 77e6cf
scale_size_continuous(range = c(1,10)) +
theme_void() +
labs(color = "Sample type", size = "No. Samples", shape = "No. Samples") +
theme(panel.grid.major = element_blank())
all_samples_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray90") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
scale_size_continuous(range = c(1,10)) +
theme_void() +
labs(color = "Sample type", size = "No. Samples", shape = "No. Samples") +
theme(panel.grid.major = element_blank())
all_samples_world
all_samples_world <- ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray90") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
scale_size_continuous(range = c(1,10)) +
theme_void() +
labs(color = "Sample type", size = "No. Samples", shape = "Sample type") +
theme(panel.grid.major = element_blank())
all_samples_world
ggplot(world) +
geom_sf(aes(geometry = geom), fill = "gray90", color = "gray70") +
# geom_point(data = continent_info, aes(long, lat, color = No_samples, size = No_MAGs), shape = 19) +
ggpointgrid::geom_pointrect(data = continent_info_counts, aes(long, lat, color = Full, shape = Full, size = counts), scale_x = 8.0, scale_y = 8.0, stroke = 1.5) +
scale_shape_manual(values = c(18,5,1,16,2,17,0,15,9,14)) +
scale_color_manual(values = c("#feb24c","#feb24c","#FF3200","#FF3200","#82CDAA","#82CDAA","#065FA3","#065FA3","#cd82a5","#cd82a5")) +
# scale_color_gradient(low = "gray90", high = "#e6778e", na.value = "white", name = "No. samples", breaks=c(1000,2000,3000,4000,5000,6000,7000)) + # e6778e 77e6cf
scale_size_continuous(range = c(2,12)) +
theme_void() +
labs(fill = "Sample type", size = "No. Samples", shape = "Sample type") +
theme(panel.grid.major = element_blank())
ac_age_ridge <- continent_info  %>%
mutate(Full = ifelse(Sample_type == "calculus" & str_detect(Full, "Baboon|Chimpanzee|Gorilla|Howler"),"NHP - calculus", Full)) %>%
filter(Country != "Venezuela") %>%
filter(Full == "Calculus - Ancient") %>%
filter(Continent != "Unknown",
!is.na(Age_BP)) %>%
mutate(Continent = str_replace_all(Continent, "Caribbean","South America"),
Continent = fct_relevel(Continent,"South America","North America","Oceania","Asia","Africa","Europe")) %>%
# filter(Continent == "South America")
ggplot(., aes(x = Age_BP, y = Continent, fill = Full)) +
geom_density_ridges(bandwidth = 200, jittered_points = TRUE, position = position_points_jitter(width = 0.05, height = 0),
point_shape = '|', point_size = 3, point_alpha = 1, alpha = 1.0,  scale = 0.9) + # rel_min_height = 0.01 scale = 0.9
scale_x_reverse(breaks=scales::pretty_breaks(n=10)) + # breaks=scales::pretty_breaks(n=10)
scale_y_discrete(position = "right") +
theme_classic(base_size = 14) +
scale_fill_manual(values = c("#feb24c")) +
theme(panel.grid.minor.x = element_blank()) +
guides(fill="none") +
xlab("Age (BP)")
ac_age_ridge
all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1.5,1))
ac_world + ac_europe +
plot_layout(guides = "collect")
all_samples_world / ac_age_ridge +
plot_layout(heights = c(1.5,1))
all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1.5,1))
ac_world + ac_europe +
plot_layout(guides = "collect")
sample_plot_main <- all_samples_world / ac_age_ridge +
plot_layout(guides = "collect", heights = c(1.5,1))
sample_plot_main
sample_plot_ac <- ac_world + ac_europe +
plot_layout(guides = "collect")
sample_plot_ac
ggsave("./06-publication/main_figures/Figure_xx8/sample_world_plot.pdf", plot = sample_plot_main, device = "pdf",
scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
ggsave("./06-publication/supplemental_figures/Figure_S6/ac_world_europe_plot.pdf", plot = sample_plot_ac, device = "pdf",
scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
ggsave("./06-publication/supplemental_figures/Sup_fig_S6/ac_world_europe_plot.pdf", plot = sample_plot_ac, device = "pdf",
scale = 1, width = 4, height = 4, units = c("in"), dpi = 300)
ggsave("./06-publication/supplemental_figures/Sup_fig_S6/ac_world_europe_plot.pdf", plot = sample_plot_ac, device = "pdf",
scale = 1, width = 8, height = 4, units = c("in"), dpi = 300)
ggsave("./06-publication/main_figures/Figure_xx8/sample_world_plot.pdf", plot = sample_plot_main, device = "pdf",
scale = 1, width = 8, height = 4, units = c("in"), dpi = 300)
ggsave("./06-publication/main_figures/Figure_xx8/sample_world_plot.pdf", plot = sample_plot_main, device = "pdf",
scale = 1, width = 10, height = 4, units = c("in"), dpi = 300)
ggsave("./06-publication/main_figures/Figure_xx8/sample_world_plot.pdf", plot = sample_plot_main, device = "pdf",
scale = 1, width = 15, height = 6, units = c("in"), dpi = 300)
View(continent_ac_age_counts)
View(continent_ac_age_counts)
View(continent_info)
View(continent_info_counts)
sample_plot_ac <- ac_world + ac_europe +
plot_layout(guides = "collect")
sample_plot_ac
q()
